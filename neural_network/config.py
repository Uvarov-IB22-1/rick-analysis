import numpy as np


def relu(t):
    '''Функция активации нейронной сети'''
    return np.maximum(t, 0)


def softmax(t):
    '''Превращает произвольный вектор в набор вероятностей'''
    e = np.exp(t)
    return e / np.sum(e)


def predict(x, W1, W2, b1, b2):
    '''Возвращает вектор из 3 вероятностей'''
    h1 = relu(x @ W1 + b1)
    return softmax(h1 @ W2 + b2)


def softmax_batch(t):
    out = np.exp(t)
    return out / np.sum(out, axis=1, keepdims=True)


def cross_entropy(z, y):
    return -np.log(z[0, y])


def cross_entropy_batch(z, y):
    return -np.log(np.array([z[j, y[j]] for j in range(len(y))]))


def one_hot_encoding(y, num_classes):
    y_full = np.zeros((1, num_classes))
    y_full[0, y] = 1
    return y_full


def one_hot_encoding_batch(y, num_classes):
    y_full = np.zeros((len(y), num_classes))
    for j, yj in enumerate(y):
        y_full[j, yj] = 1
    return y_full


def relu_deriv(t):
    return (t >= 0).astype(float)


def calc_accuracy(dataset, W1, W2, b1, b2):
    correct = 0
    for x, y in dataset:
        z = predict(x, W1, W2, b1, b2)
        y_pred = np.argmax(z)
        if y_pred == y:
            correct += 1
    acc = correct / len(dataset)
    return acc


THREAT = 4 #количество входных угроз
RISK = 3 #количество классов рисков
NEURONS = 10 #количество нейронов в скрытом слое


ALPHA = 0.0002
EPOCHS = 4000 #400
BATCH_SIZE = 50


selection = [[71, 0, 51, 4], [47, 24, 7, 48], [3, 68, 88, 0], [43, 14, 50, 19], [77, 3, 17, 21], [23, 22, 86, 15], [1, 28, 48, 61], [41, 4, 52, 16], [73, 0, 52, 34], [16, 70, 22, 17], [27, 59, 3, 30], [52, 1, 34, 40], [15, 23, 15, 31], [34, 43, 63, 8], [9, 9, 11, 26], [0, 40, 31, 76], [61, 31, 12, 45], [6, 53, 87, 2], [35, 0, 56, 58], [55, 31, 20, 41], [4, 79, 47, 11], [0, 33, 19, 51], [30, 27, 79, 16], [3, 99, 3, 26], [54, 69, 6, 29], [4, 23, 9, 67], [57, 0, 44, 31], [77, 18, 30, 0], [30, 27, 43, 38], [18, 20, 54, 39], [20, 28, 39, 57], [90, 32, 3, 26], [20, 3, 79, 14], [53, 37, 41, 9], [2, 73, 12, 54], [16, 11, 9, 51], [7, 92, 6, 55], [86, 11, 33, 3], [25, 48, 13, 45], [50, 13, 13, 32], [27, 7, 41, 8], [1, 45, 53, 20], [94, 3, 27, 13], [15, 29, 30, 58], [57, 7, 48, 26], [78, 14, 19, 43], [48, 3, 14, 24], [50, 5, 2, 90], [43, 28, 47, 10], [75, 11, 10, 37], [0, 76, 18, 36], [12, 45, 73, 18], [73, 14, 46, 15], [3, 64, 2, 5], [53, 8, 45, 37], [13, 43, 48, 20], [33, 54, 9, 14], [45, 36, 66, 4], [19, 41, 53, 22], [47, 13, 30, 47], [22, 2, 62, 49], [7, 26, 96, 8], [3, 41, 42, 0], [64, 1, 14, 72], [10, 11, 44, 42], [40, 12, 8, 14], [9, 25, 49, 68], [7, 37, 70, 0], [10, 10, 63, 44], [6, 0, 78, 32], [40, 12, 14, 23], [35, 15, 31, 74], [15, 48, 61, 4], [1, 13, 36, 62], [10, 18, 22, 80], [6, 70, 60, 3], [9, 15, 62, 24], [10, 68, 11, 58], [38, 43, 49, 23], [22, 66, 14, 55], [0, 10, 90, 39], [55, 39, 6, 42], [20, 75, 35, 20], [94, 6, 42, 10], [13, 9, 24, 26], [36, 38, 11, 55], [30, 12, 34, 83], [40, 7, 4, 95], [58, 6, 21, 12], [34, 25, 67, 24], [62, 61, 5, 12], [33, 56, 13, 7], [25, 49, 41, 4], [9, 48, 68, 6], [25, 17, 46, 16], [60, 31, 14, 11], [15, 70, 39, 5], [100, 8, 2, 38], [18, 21, 52, 35], [15, 69, 43, 27], [36, 36, 0, 27], [35, 10, 53, 56], [22, 26, 78, 27], [10, 31, 16, 66], [2, 2, 60, 15], [54, 13, 58, 27], [45, 22, 17, 65], [60, 33, 51, 3], [25, 47, 2, 18], [58, 21, 43, 31], [10, 40, 29, 53], [59, 38, 34, 10], [68, 6, 21, 3], [9, 12, 57, 1], [15, 36, 44, 48], [70, 49, 13, 8], [15, 13, 88, 8], [18, 1, 58, 34], [53, 25, 38, 26], [17, 59, 3, 75], [35, 75, 18, 22], [36, 19, 26, 49], [17, 43, 67, 9], [72, 25, 10, 20], [4, 83, 17, 51], [5, 11, 7, 75], [49, 44, 15, 37], [76, 18, 29, 24], [0, 89, 6, 8], [29, 56, 11, 12], [54, 43, 14, 22], [27, 26, 67, 34], [42, 86, 2, 26], [13, 43, 30, 25], [14, 42, 45, 27], [59, 81, 2, 8], [30, 40, 18, 61], [76, 33, 4, 38], [41, 52, 10, 43], [31, 4, 88, 30], [24, 54, 18, 29], [13, 70, 17, 27], [14, 54, 67, 3], [10, 70, 48, 22], [20, 13, 28, 79], [44, 18, 10, 49], [53, 14, 58, 7], [57, 52, 22, 9], [53, 45, 36, 21], [0, 65, 59, 27], [70, 40, 2, 18], [38, 11, 26, 55], [11, 85, 3, 0], [18, 72, 44, 14], [52, 8, 25, 69], [54, 59, 4, 34], [15, 7, 80, 32], [21, 21, 83, 25], [2, 98, 0, 5], [11, 27, 31, 60], [14, 56, 58, 27], [21, 36, 9, 75], [5, 72, 51, 4], [27, 34, 25, 56], [1, 53, 54, 36], [6, 2, 21, 79], [36, 25, 9, 80], [54, 21, 11, 3], [22, 54, 4, 73], [6, 53, 14, 65], [59, 31, 4, 35], [8, 55, 11, 82], [73, 42, 41, 2], [5, 6, 39, 47], [4, 12, 12, 3], [31, 49, 32, 11], [21, 0, 61, 33], [72, 9, 67, 8], [51, 8, 10, 12], [38, 64, 40, 2], [46, 24, 16, 66], [61, 17, 15, 6], [48, 15, 4, 32], [36, 26, 10, 11], [9, 35, 69, 40], [6, 41, 32, 12], [78, 19, 22, 40], [7, 41, 0, 83], [30, 0, 11, 35], [28, 59, 24, 7], [27, 85, 38, 7], [5, 22, 22, 30], [30, 13, 34, 1], [24, 9, 68, 39], [19, 72, 55, 12], [45, 29, 7, 66], [51, 18, 0, 58], [48, 5, 8, 6], [8, 38, 8, 65], [37, 12, 12, 24], [8, 35, 85, 3], [16, 98, 8, 9], [44, 35, 36, 4], [7, 48, 14, 17], [88, 35, 19, 8], [10, 38, 81, 6], [37, 16, 47, 17], [5, 18, 77, 46], [24, 25, 2, 92], [38, 47, 20, 53], [87, 41, 1, 5], [82, 29, 36, 1], [53, 36, 1, 33], [13, 63, 19, 50], [11, 14, 50, 54], [17, 17, 6, 28], [48, 33, 26, 16], [35, 37, 13, 73], [18, 18, 59, 28], [37, 82, 21, 18], [53, 28, 21, 54], [87, 4, 12, 50], [2, 37, 92, 3], [38, 70, 20, 7], [12, 18, 52, 66], [9, 8, 30, 4], [0, 60, 41, 35], [2, 39, 50, 45], [57, 9, 7, 82], [16, 38, 39, 65], [31, 18, 91, 7], [15, 22, 89, 31], [76, 16, 20, 7], [16, 34, 11, 85], [25, 94, 0, 8], [86, 31, 33, 5], [6, 61, 1, 9], [5, 10, 78, 51], [16, 70, 18, 10], [19, 0, 26, 67], [78, 39, 20, 9], [31, 15, 73, 23], [30, 3, 68, 31], [76, 29, 2, 51], [24, 10, 39, 7], [59, 8, 23, 68], [23, 40, 28, 38], [19, 7, 25, 71], [37, 13, 59, 39], [4, 2, 32, 0], [28, 35, 31, 29], [31, 63, 7, 57], [6, 31, 25, 7], [31, 28, 18, 20], [25, 32, 45, 5], [29, 74, 10, 46], [36, 14, 24, 3], [8, 22, 2, 9], [28, 15, 56, 15], [71, 35, 24, 16], [9, 8, 34, 66], [80, 26, 11, 38], [10, 10, 47, 65], [65, 25, 22, 17], [68, 34, 37, 17], [4, 6, 65, 42], [30, 3, 54, 50], [13, 30, 52, 47], [72, 68, 14, 1], [17, 61, 8, 21], [31, 8, 80, 40], [7, 23, 81, 21], [18, 18, 5, 19], [77, 10, 19, 28], [21, 15, 67, 1], [5, 49, 12, 88], [60, 40, 32, 14], [3, 89, 36, 19], [17, 27, 12, 17], [45, 55, 10, 2], [5, 25, 89, 11], [72, 52, 16, 19], [18, 62, 4, 10], [3, 5, 11, 11], [10, 15, 19, 77], [7, 12, 14, 10], [27, 54, 17, 27], [62, 24, 42, 5], [47, 4, 2, 10], [20, 74, 32, 9], [28, 54, 8, 59], [29, 69, 4, 37], [59, 6, 67, 13], [9, 30, 13, 11], [52, 9, 69, 26], [16, 31, 14, 93], [31, 10, 48, 58], [86, 0, 9, 17], [14, 0, 70, 5], [18, 74, 27, 27], [0, 38, 75, 35], [62, 21, 19, 50], [8, 30, 92, 10], [22, 12, 58, 40], [53, 26, 44, 21], [12, 25, 36, 41], [57, 19, 28, 10], [46, 81, 26, 3], [12, 8, 28, 43], [59, 23, 38, 26], [33, 25, 6, 23], [5, 2, 81, 24], [46, 42, 4, 61], [17, 36, 0, 49], [47, 26, 1, 34], [38, 35, 54, 18], [72, 18, 26, 11], [45, 18, 28, 50], [43, 10, 34, 73], [27, 17, 23, 33], [9, 82, 24, 33], [19, 50, 5, 83], [88, 2, 42, 27], [37, 65, 8, 14], [48, 8, 70, 26], [20, 19, 33, 71], [74, 26, 13, 33], [30, 51, 27, 24], [55, 34, 55, 14], [20, 58, 32, 31], [46, 59, 36, 15], [45, 34, 25, 16], [97, 4, 17, 8], [35, 44, 39, 17], [8, 38, 47, 7], [93, 15, 14, 8], [22, 24, 82, 13], [1, 21, 20, 8], [53, 32, 21, 5], [18, 16, 66, 20], [25, 50, 6, 17], [13, 14, 32, 39], [46, 0, 20, 75], [6, 24, 69, 52], [18, 43, 39, 6], [59, 62, 30, 3], [19, 21, 61, 8], [50, 8, 8, 23], [27, 20, 73, 0], [40, 20, 17, 6], [40, 13, 1, 26], [6, 22, 28, 28], [10, 72, 9, 27], [70, 15, 4, 59], [70, 50, 31, 1], [15, 18, 17, 91], [77, 38, 39, 1], [16, 27, 94, 19], [39, 66, 21, 34], [20, 25, 21, 3], [4, 58, 14, 23], [71, 7, 11, 54], [10, 50, 0, 49], [10, 54, 44, 49], [59, 45, 43, 13], [36, 14, 33, 62], [3, 21, 38, 91], [20, 34, 21, 67], [14, 44, 71, 20], [35, 3, 7, 79], [50, 60, 23, 9], [15, 22, 30, 27], [28, 51, 53, 22], [1, 13, 32, 1], [21, 7, 5, 92], [23, 58, 59, 4], [32, 15, 0, 30], [14, 4, 56, 10], [14, 53, 44, 0], [18, 50, 37, 38], [43, 45, 24, 33], [6, 28, 17, 21], [8, 61, 44, 38], [1, 34, 77, 5], [51, 9, 15, 38], [31, 10, 20, 15], [20, 62, 38, 29], [28, 6, 44, 15], [23, 1, 13, 60], [48, 13, 45, 30], [45, 12, 12, 53], [70, 47, 9, 27], [39, 5, 70, 24], [15, 51, 69, 6], [52, 29, 1, 64], [51, 21, 57, 29], [11, 51, 2, 4], [23, 88, 25, 8], [22, 47, 2, 67], [12, 30, 17, 93], [2, 12, 7, 34], [39, 37, 35, 33], [24, 80, 0, 12], [54, 38, 3, 14], [33, 7, 20, 11], [46, 17, 14, 16], [74, 7, 63, 0], [19, 59, 54, 13], [46, 63, 36, 10], [23, 18, 43, 2], [10, 83, 9, 46], [9, 53, 37, 40], [14, 45, 43, 58], [50, 35, 9, 20], [5, 4, 12, 22], [28, 36, 19, 45], [54, 31, 48, 11], [49, 63, 5, 9], [60, 12, 60, 26], [9, 23, 31, 44], [34, 7, 16, 100], [42, 10, 60, 12], [54, 40, 55, 5], [47, 60, 11, 33], [27, 15, 23, 57], [15, 37, 24, 58], [16, 1, 36, 85], [29, 41, 23, 6], [39, 16, 87, 9], [14, 40, 26, 27], [60, 34, 10, 11], [25, 16, 21, 76], [87, 15, 6, 39], [0, 19, 17, 58], [54, 64, 16, 14], [60, 35, 25, 10], [92, 30, 14, 0], [38, 59, 36, 22], [5, 37, 41, 68], [91, 6, 8, 35], [26, 6, 62, 28], [0, 20, 17, 64], [23, 1, 28, 3], [48, 2, 45, 47], [25, 56, 1, 75], [56, 9, 17, 38], [67, 29, 7, 11], [2, 86, 43, 7], [13, 53, 19, 19], [33, 95, 9, 5], [37, 0, 31, 52], [27, 47, 34, 46], [43, 5, 31, 34], [30, 57, 11, 19], [26, 35, 13, 42], [4, 68, 12, 40], [15, 46, 6, 15], [29, 57, 36, 16], [52, 14, 26, 12], [60, 44, 43, 0], [67, 12, 42, 21], [0, 12, 26, 99], [17, 44, 76, 3], [94, 0, 1, 20], [7, 48, 99, 4], [5, 24, 24, 32], [27, 71, 26, 29], [35, 50, 44, 13], [59, 32, 22, 45], [5, 35, 37, 43], [11, 4, 40, 33], [78, 7, 26, 47], [19, 78, 29, 21], [16, 35, 21, 48], [91, 29, 28, 11], [41, 20, 27, 18], [52, 5, 72, 29], [64, 29, 35, 25], [4, 15, 4, 0], [27, 16, 78, 21], [66, 9, 7, 59], [55, 51, 24, 7], [42, 1, 57, 45], [1, 52, 10, 80], [53, 53, 4, 19], [62, 0, 28, 52], [2, 25, 25, 15], [50, 3, 81, 9], [4, 30, 33, 18], [50, 75, 0, 28], [39, 24, 20, 41], [50, 74, 24, 1], [23, 26, 25, 20], [41, 51, 2, 64], [34, 34, 13, 11], [45, 18, 4, 89], [68, 46, 13, 11], [0, 17, 82, 33], [4, 15, 15, 51], [71, 20, 20, 46], [70, 17, 45, 92], [76, 8, 34, 97], [29, 17, 85, 97], [85, 22, 22, 69], [66, 11, 66, 80], [77, 29, 14, 88], [38, 34, 92, 84], [78, 36, 56, 72], [34, 100, 18, 27], [21, 49, 14, 86], [21, 92, 77, 84], [10, 70, 94, 41], [38, 39, 98, 58], [58, 80, 73, 43], [40, 73, 55, 55], [60, 87, 20, 12], [79, 1, 56, 50], [14, 28, 58, 69], [44, 37, 59, 50], [9, 90, 78, 76], [50, 57, 27, 72], [64, 57, 85, 60], [95, 78, 48, 50], [95, 40, 16, 89], [30, 31, 86, 82], [70, 36, 89, 72], [90, 12, 1, 93], [44, 70, 80, 42], [60, 13, 30, 87], [77, 99, 17, 25], [19, 94, 68, 7], [21, 84, 47, 86], [46, 33, 96, 56], [37, 57, 42, 65], [0, 87, 95, 58], [80, 29, 81, 23], [25, 56, 54, 99], [75, 54, 67, 36], [62, 48, 65, 95], [99, 56, 11, 67], [97, 97, 28, 31], [54, 22, 75, 65], [74, 66, 70, 4], [64, 74, 76, 28], [82, 53, 64, 3], [84, 45, 20, 78], [49, 64, 97, 68], [94, 70, 15, 9], [29, 88, 61, 84], [53, 34, 71, 77], [36, 23, 52, 77], [45, 55, 89, 74], [72, 87, 53, 67], [9, 88, 92, 70], [5, 70, 40, 92], [22, 82, 92, 22], [55, 34, 88, 7], [60, 60, 90, 18], [48, 28, 67, 42], [74, 60, 56, 62], [40, 14, 91, 26], [28, 56, 21, 98], [55, 44, 79, 12], [32, 43, 92, 62], [56, 36, 33, 57], [98, 3, 72, 17], [93, 89, 64, 31], [78, 65, 56, 38], [73, 0, 55, 38], [60, 91, 18, 24], [81, 75, 68, 34], [86, 30, 71, 80], [69, 83, 18, 47], [63, 48, 84, 17], [94, 18, 41, 18], [64, 95, 19, 8], [59, 59, 57, 17], [52, 66, 70, 57], [63, 22, 62, 42], [51, 27, 31, 68], [63, 32, 9, 66], [97, 7, 57, 64], [30, 15, 49, 88], [33, 57, 79, 51], [79, 99, 5, 60], [81, 56, 36, 65], [53, 66, 43, 26], [35, 0, 94, 100], [51, 43, 18, 83], [13, 91, 4, 84], [91, 8, 19, 75], [72, 75, 42, 10], [22, 40, 67, 73], [19, 61, 63, 65], [90, 37, 12, 44], [23, 35, 77, 47], [98, 12, 31, 38], [79, 72, 80, 32], [35, 45, 92, 78], [49, 86, 73, 44], [3, 95, 72, 84], [63, 30, 87, 16], [41, 73, 49, 84], [17, 42, 77, 31], [6, 78, 80, 58], [56, 86, 61, 66], [28, 88, 12, 85], [31, 38, 76, 67], [78, 49, 17, 81], [35, 68, 61, 69], [100, 76, 51, 12], [50, 44, 89, 39], [44, 33, 94, 97], [87, 17, 74, 18], [75, 55, 68, 30], [100, 67, 17, 94], [35, 91, 68, 9], [7, 64, 85, 54], [21, 28, 56, 72], [69, 29, 15, 83], [39, 70, 24, 72], [54, 74, 47, 72], [45, 15, 72, 76], [36, 74, 7, 96], [46, 17, 46, 92], [95, 56, 58, 24], [57, 19, 41, 80], [82, 35, 69, 61], [25, 46, 99, 60], [28, 48, 10, 80], [84, 44, 53, 99], [43, 30, 37, 94], [61, 42, 3, 91], [52, 25, 20, 98], [53, 100, 25, 15], [58, 76, 67, 8], [96, 76, 40, 8], [38, 33, 91, 90], [58, 28, 44, 64], [30, 50, 54, 51], [44, 11, 64, 61], [41, 14, 24, 89], [55, 2, 89, 69], [95, 61, 59, 56], [78, 63, 2, 61], [90, 25, 21, 45], [77, 63, 7, 66], [53, 90, 69, 8], [7, 89, 93, 45], [39, 83, 65, 45], [44, 91, 84, 34], [85, 66, 72, 6], [97, 59, 60, 15], [61, 35, 98, 28], [96, 10, 20, 42], [7, 79, 84, 85], [5, 88, 9, 78], [76, 59, 90, 46], [59, 52, 6, 55], [65, 59, 18, 54], [4, 90, 72, 61], [36, 72, 82, 61], [7, 72, 83, 24], [52, 30, 66, 77], [95, 41, 0, 55], [47, 1, 100, 43], [77, 54, 6, 48], [38, 33, 61, 87], [95, 22, 98, 14], [50, 15, 86, 87], [2, 54, 82, 92], [98, 81, 25, 68], [78, 96, 3, 32], [89, 91, 53, 41], [89, 14, 24, 42], [71, 11, 79, 98], [83, 35, 97, 38], [23, 75, 92, 69], [53, 27, 64, 23], [16, 56, 61, 50], [54, 8, 76, 38], [58, 64, 39, 82], [63, 86, 78, 48], [26, 49, 78, 86], [100, 12, 42, 16], [79, 10, 79, 53], [71, 18, 88, 22], [54, 72, 4, 38], [5, 63, 23, 89], [41, 16, 91, 72], [29, 16, 64, 60], [73, 33, 48, 75], [19, 81, 79, 39], [34, 80, 3, 92], [73, 27, 24, 89], [66, 75, 20, 28], [38, 18, 96, 18], [49, 6, 25, 86], [37, 10, 84, 73], [78, 24, 27, 61], [60, 71, 10, 23], [95, 77, 43, 64], [33, 21, 85, 63], [72, 18, 72, 79], [45, 60, 71, 62], [43, 34, 85, 23], [53, 31, 89, 93], [5, 69, 79, 76], [76, 43, 77, 32], [59, 73, 10, 49], [31, 69, 18, 69], [22, 40, 86, 54], [63, 31, 71, 65], [20, 71, 94, 8], [72, 31, 73, 84], [97, 46, 59, 43], [43, 12, 80, 79], [25, 60, 82, 57], [99, 95, 47, 21], [69, 88, 18, 25], [35, 92, 97, 13], [23, 45, 100, 57], [16, 2, 96, 86], [6, 61, 98, 73], [41, 53, 30, 66], [80, 51, 33, 8], [44, 80, 86, 4], [78, 3, 65, 56], [48, 56, 90, 22], [2, 48, 100, 21], [29, 39, 92, 62], [44, 90, 68, 46], [71, 64, 68, 54], [63, 55, 88, 54], [84, 13, 27, 67], [94, 79, 54, 29], [2, 99, 70, 89], [60, 9, 80, 46], [42, 93, 70, 16], [17, 75, 49, 64], [27, 55, 21, 70], [73, 10, 51, 51], [21, 92, 96, 12], [61, 7, 70, 55], [96, 29, 74, 53], [72, 23, 81, 18], [55, 95, 97, 17], [49, 55, 41, 67], [88, 17, 58, 16], [100, 35, 21, 30], [47, 25, 60, 37], [4, 78, 30, 60], [50, 16, 84, 26], [65, 96, 47, 48], [2, 85, 97, 28], [56, 84, 57, 43], [88, 36, 63, 35], [76, 27, 74, 65], [43, 12, 33, 81], [79, 31, 69, 38], [87, 40, 10, 82], [18, 99, 64, 10], [50, 42, 45, 28], [70, 45, 67, 60], [54, 51, 91, 39], [18, 65, 57, 40], [46, 79, 34, 29], [57, 66, 91, 21], [50, 88, 41, 95], [52, 94, 50, 80], [78, 17, 59, 54], [50, 6, 67, 61], [24, 60, 45, 98], [33, 84, 22, 52], [41, 92, 52, 27], [64, 75, 41, 54], [93, 85, 10, 68], [10, 57, 52, 81], [36, 63, 37, 51], [82, 76, 3, 74], [13, 42, 35, 84], [31, 66, 85, 57], [85, 59, 52, 40], [30, 62, 41, 53], [28, 67, 69, 87], [82, 59, 43, 7], [51, 37, 11, 99], [55, 32, 71, 78], [56, 90, 45, 0], [69, 67, 74, 47], [49, 42, 36, 85], [8, 88, 56, 34], [4, 76, 97, 17], [54, 73, 72, 11], [74, 31, 34, 34], [68, 6, 70, 86], [58, 91, 53, 50], [39, 55, 79, 94], [15, 94, 79, 39], [26, 57, 50, 83], [35, 45, 47, 75], [51, 34, 68, 100], [54, 34, 13, 90], [93, 79, 33, 61], [55, 69, 48, 41], [57, 14, 98, 8], [49, 94, 67, 68], [83, 51, 51, 51], [46, 65, 41, 60], [63, 28, 90, 5], [36, 35, 45, 71], [59, 40, 56, 91], [60, 88, 6, 95], [81, 1, 50, 49], [90, 49, 48, 37], [24, 50, 82, 84], [82, 54, 63, 35], [39, 34, 0, 97], [36, 8, 82, 75], [23, 71, 8, 67], [38, 87, 1, 81], [68, 43, 92, 40], [72, 59, 20, 93], [84, 26, 46, 65], [21, 18, 80, 93], [85, 50, 21, 45], [95, 71, 89, 6], [7, 97, 35, 89], [67, 46, 17, 55], [66, 63, 59, 74], [98, 31, 27, 70], [33, 46, 79, 67], [92, 63, 0, 33], [8, 90, 93, 47], [70, 67, 78, 64], [62, 87, 8, 16], [63, 69, 74, 70], [50, 97, 21, 59], [68, 61, 29, 52], [59, 7, 30, 92], [66, 8, 90, 71], [62, 55, 81, 78], [99, 23, 22, 44], [47, 62, 42, 45], [25, 8, 82, 57], [49, 93, 19, 94], [65, 7, 96, 53], [35, 33, 69, 51], [96, 44, 33, 90], [89, 29, 6, 40], [47, 25, 99, 82], [2, 52, 73, 53], [89, 72, 2, 74], [40, 89, 23, 97], [20, 74, 33, 46], [28, 41, 82, 26], [13, 87, 47, 96], [73, 39, 53, 86], [2, 32, 95, 83], [65, 89, 82, 10], [48, 41, 85, 92], [44, 83, 32, 73], [24, 78, 74, 62], [59, 22, 29, 91], [54, 41, 24, 98], [75, 31, 64, 74], [91, 98, 42, 40], [90, 32, 71, 45], [62, 31, 62, 41], [70, 63, 34, 81], [31, 13, 70, 96], [63, 95, 69, 11], [99, 82, 9, 86], [47, 74, 44, 99], [30, 91, 96, 21], [100, 15, 54, 73], [8, 68, 64, 37], [40, 31, 99, 21], [12, 93, 19, 49], [14, 4, 90, 84], [33, 25, 85, 42], [80, 100, 3, 14], [52, 50, 64, 35], [29, 74, 68, 35], [99, 8, 55, 84], [45, 80, 69, 11], [98, 46, 78, 52], [83, 15, 92, 46], [71, 95, 38, 26], [93, 23, 45, 94], [76, 88, 8, 13], [8, 7, 80, 100], [85, 73, 19, 27], [54, 72, 39, 68], [37, 7, 87, 34], [96, 85, 51, 22], [8, 84, 41, 98], [27, 71, 76, 96], [75, 86, 93, 7], [66, 44, 93, 17], [72, 8, 67, 92], [37, 84, 62, 36], [16, 81, 87, 60], [72, 78, 13, 70], [55, 49, 89, 58], [58, 21, 7, 95], [50, 31, 36, 91], [81, 40, 95, 44], [45, 84, 6, 71], [15, 20, 77, 98], [54, 51, 35, 92], [7, 76, 47, 90], [93, 18, 71, 69], [77, 9, 82, 49], [40, 49, 84, 83], [59, 21, 62, 81], [30, 87, 71, 65], [69, 44, 10, 79], [34, 47, 93, 1], [97, 25, 33, 91], [72, 17, 36, 87], [81, 84, 2, 2], [49, 43, 79, 85], [20, 56, 72, 87], [8, 67, 40, 71], [88, 33, 69, 88], [54, 48, 60, 67], [20, 64, 78, 34], [6, 7, 77, 88], [33, 71, 96, 54], [61, 64, 36, 25], [17, 34, 79, 56], [24, 62, 38, 81], [16, 58, 86, 40], [63, 12, 13, 88], [52, 38, 70, 48], [69, 77, 81, 13], [89, 48, 19, 8], [53, 81, 63, 76], [3, 82, 25, 63], [20, 4, 90, 60], [68, 40, 29, 51], [19, 59, 99, 75], [26, 21, 77, 62], [31, 42, 34, 65], [93, 66, 22, 26], [85, 53, 49, 29], [78, 20, 50, 51], [70, 74, 0, 98], [86, 84, 7, 60], [33, 28, 74, 77], [36, 93, 61, 16], [87, 65, 26, 88], [52, 25, 44, 85], [14, 36, 47, 90], [42, 54, 84, 80], [62, 78, 40, 55], [68, 57, 16, 43], [95, 36, 41, 46], [38, 80, 75, 25], [64, 59, 90, 31], [80, 16, 91, 17], [92, 17, 50, 88], [35, 89, 53, 72], [23, 77, 68, 5], [68, 51, 73, 63], [12, 76, 30, 47], [72, 21, 88, 75], [46, 81, 12, 88], [59, 50, 55, 4], [94, 58, 48, 52], [45, 53, 97, 9], [9, 51, 42, 81], [63, 7, 69, 67], [36, 43, 94, 79], [96, 28, 82, 57], [1, 22, 77, 92], [62, 16, 72, 68], [0, 55, 84, 70], [10, 50, 77, 30], [89, 17, 26, 71], [5, 48, 99, 21], [61, 25, 99, 47], [29, 55, 34, 59], [69, 7, 93, 70], [73, 43, 0, 51], [84, 78, 43, 34], [36, 100, 83, 61], [67, 5, 69, 24], [87, 61, 15, 32], [1, 91, 98, 52], [12, 82, 34, 38], [19, 22, 98, 63], [35, 79, 100, 20], [57, 85, 48, 45], [38, 99, 38, 70], [41, 69, 29, 30], [62, 46, 91, 0], [24, 69, 75, 70], [99, 48, 78, 36], [57, 95, 45, 98], [90, 93, 53, 51], [97, 82, 100, 17], [91, 33, 84, 77], [96, 17, 77, 98], [92, 56, 88, 71], [30, 85, 99, 90], [75, 81, 85, 45], [52, 95, 59, 95], [63, 67, 100, 84], [81, 90, 81, 60], [86, 98, 80, 63], [64, 90, 53, 89], [41, 92, 98, 81], [21, 86, 97, 98], [76, 82, 97, 37], [97, 79, 53, 76], [84, 88, 46, 88], [89, 75, 53, 76], [60, 92, 95, 62], [100, 84, 43, 77], [59, 84, 96, 70], [83, 98, 67, 97], [100, 27, 90, 89], [86, 93, 79, 96], [97, 38, 79, 75], [77, 66, 57, 88], [92, 100, 96, 98], [70, 95, 45, 80], [37, 83, 76, 91], [86, 68, 93, 89], [51, 89, 72, 98], [28, 73, 100, 90], [75, 56, 75, 96], [99, 100, 44, 94], [79, 65, 86, 71], [54, 100, 76, 61], [68, 43, 97, 85], [68, 88, 96, 49], [98, 42, 99, 79], [99, 96, 53, 48], [80, 69, 73, 85], [55, 96, 91, 53], [95, 33, 96, 78], [65, 68, 76, 97], [84, 95, 75, 82], [51, 64, 93, 97], [95, 57, 60, 86], [91, 95, 69, 34], [98, 100, 94, 27], [100, 24, 77, 98], [49, 98, 89, 72], [76, 41, 99, 85], [82, 63, 93, 77], [73, 93, 97, 22], [32, 99, 77, 89], [92, 9, 90, 98], [15, 80, 93, 97], [81, 99, 89, 68], [96, 64, 70, 62], [94, 83, 77, 69], [88, 56, 71, 90], [58, 79, 92, 55], [67, 71, 83, 88], [78, 95, 65, 66], [66, 91, 98, 33], [62, 84, 96, 69], [77, 36, 80, 98], [89, 95, 83, 83], [65, 89, 85, 66], [100, 67, 63, 92], [83, 74, 87, 86], [100, 70, 65, 65], [95, 64, 57, 96], [87, 72, 74, 54], [67, 52, 98, 85], [63, 99, 92, 80], [81, 87, 62, 76], [92, 68, 45, 84], [56, 99, 77, 64], [40, 87, 98, 83], [95, 78, 96, 48], [91, 68, 53, 73], [78, 96, 46, 65], [86, 97, 100, 80], [88, 68, 83, 86], [49, 88, 93, 65], [92, 93, 49, 56], [67, 82, 60, 80], [67, 96, 98, 76], [49, 98, 77, 70], [93, 83, 66, 97], [83, 89, 75, 65], [80, 91, 65, 92], [82, 84, 70, 69], [67, 48, 97, 73], [69, 83, 65, 81], [88, 33, 100, 89], [75, 91, 85, 65], [80, 78, 75, 87], [86, 71, 63, 70], [91, 55, 72, 98], [89, 77, 67, 91], [85, 88, 34, 90], [88, 100, 40, 65], [61, 61, 72, 97], [68, 79, 94, 62], [91, 73, 49, 98], [52, 81, 76, 75], [49, 93, 83, 66], [11, 98, 77, 100], [87, 70, 86, 96], [95, 48, 82, 98], [78, 43, 85, 98], [79, 66, 75, 88], [58, 72, 99, 67], [95, 63, 67, 94], [78, 89, 100, 20], [96, 97, 72, 24], [98, 87, 97, 36], [95, 95, 89, 26], [53, 87, 81, 92], [91, 51, 85, 69], [62, 98, 92, 35], [98, 56, 98, 71], [81, 82, 82, 49], [98, 93, 60, 41], [41, 92, 81, 70], [94, 86, 75, 92], [47, 97, 73, 79], [50, 75, 81, 97], [97, 70, 56, 62], [92, 75, 87, 46], [67, 80, 95, 62], [85, 70, 88, 66], [60, 65, 86, 98], [93, 56, 89, 67], [99, 96, 99, 3], [97, 72, 66, 93], [82, 85, 94, 68], [98, 59, 45, 84], [86, 93, 80, 45], [75, 96, 93, 83], [75, 67, 93, 60], [67, 82, 95, 81], [79, 69, 71, 87], [80, 84, 91, 37], [63, 90, 100, 34], [79, 56, 93, 90], [94, 95, 63, 51], [99, 94, 91, 33], [86, 91, 60, 74], [86, 99, 87, 82], [85, 94, 32, 74], [99, 60, 43, 98], [59, 86, 65, 92], [90, 80, 77, 84], [72, 91, 85, 41], [84, 91, 50, 88], [31, 90, 76, 94], [89, 99, 43, 90], [79, 83, 80, 98], [99, 73, 73, 50], [96, 12, 92, 96], [45, 66, 96, 80], [94, 8, 90, 92], [79, 89, 69, 74], [82, 96, 94, 63], [43, 69, 100, 82], [41, 78, 92, 90], [75, 82, 53, 100], [90, 57, 78, 67], [90, 32, 94, 100], [17, 99, 88, 98], [74, 98, 67, 84], [78, 93, 86, 42], [87, 85, 88, 44], [82, 74, 99, 48], [58, 92, 79, 61], [92, 72, 77, 75], [69, 100, 88, 80], [99, 85, 16, 84], [43, 65, 96, 88], [51, 75, 72, 97], [79, 94, 65, 82], [85, 30, 100, 97], [66, 89, 92, 97], [58, 83, 81, 96], [70, 99, 68, 57], [43, 99, 87, 84], [96, 95, 96, 15], [93, 97, 83, 17], [97, 87, 93, 61], [66, 70, 74, 80], [92, 46, 58, 91], [82, 92, 96, 97], [95, 92, 93, 42], [83, 48, 58, 96], [75, 85, 88, 46], [78, 79, 68, 73], [83, 89, 97, 95], [82, 92, 18, 100], [72, 92, 84, 48], [84, 98, 30, 100], [96, 51, 71, 76], [92, 72, 56, 91], [76, 99, 95, 75], [78, 74, 98, 98], [69, 88, 96, 33], [74, 80, 98, 96], [70, 97, 89, 79], [99, 70, 55, 92], [85, 80, 99, 56], [73, 44, 99, 75], [67, 50, 95, 80], [83, 83, 79, 79], [70, 81, 92, 78], [64, 81, 91, 51], [80, 30, 93, 91], [47, 80, 99, 77], [72, 79, 54, 88], [86, 87, 52, 82], [68, 56, 86, 80], [99, 85, 65, 57], [62, 88, 77, 92], [63, 86, 40, 98], [90, 76, 81, 99], [46, 85, 98, 68], [91, 33, 97, 87], [83, 49, 62, 95], [61, 83, 68, 74], [91, 100, 31, 76], [68, 63, 100, 91], [88, 91, 90, 31], [96, 70, 46, 94], [96, 90, 41, 70], [91, 91, 29, 94], [74, 97, 39, 80], [88, 95, 68, 70], [99, 52, 46, 91], [91, 45, 100, 69], [61, 95, 76, 80], [64, 73, 90, 97], [73, 77, 63, 96], [89, 72, 94, 39], [51, 45, 100, 97], [74, 83, 66, 76], [59, 80, 93, 53], [84, 44, 77, 85], [62, 85, 98, 67], [32, 90, 83, 81], [77, 98, 70, 82], [44, 100, 86, 63], [100, 91, 93, 94], [77, 56, 81, 91], [98, 45, 87, 86], [88, 90, 69, 66], [67, 99, 38, 80], [72, 59, 84, 94], [88, 96, 31, 96], [84, 95, 100, 51], [86, 61, 94, 58], [97, 90, 31, 78], [74, 83, 97, 86], [71, 83, 97, 82], [79, 98, 65, 89], [71, 96, 72, 86], [64, 84, 75, 86], [76, 79, 98, 43], [47, 96, 75, 78], [91, 40, 89, 95], [70, 96, 77, 100], [44, 85, 86, 84], [88, 98, 46, 92], [71, 97, 91, 26], [90, 87, 91, 76], [97, 83, 85, 55], [17, 85, 95, 91], [70, 67, 99, 72], [91, 93, 17, 98], [78, 74, 80, 83], [88, 95, 91, 44], [90, 68, 93, 59], [89, 92, 93, 24], [71, 69, 79, 84], [90, 62, 96, 45], [77, 100, 53, 63], [93, 75, 73, 47], [81, 88, 100, 59], [79, 89, 85, 37], [98, 68, 46, 81], [38, 92, 74, 96], [68, 63, 96, 71], [71, 97, 91, 86], [82, 84, 71, 51], [94, 68, 93, 38], [26, 85, 100, 88], [85, 74, 74, 85], [53, 92, 61, 95], [99, 27, 83, 87], [92, 42, 95, 91], [89, 86, 100, 11], [94, 85, 65, 88], [91, 77, 41, 94], [98, 37, 99, 87], [78, 65, 74, 98], [92, 84, 41, 83], [64, 97, 93, 30], [99, 94, 99, 58], [64, 98, 90, 86], [79, 39, 88, 97], [86, 59, 97, 49], [39, 75, 88, 82], [60, 50, 94, 85], [50, 71, 84, 85], [83, 86, 92, 75], [93, 75, 31, 89], [98, 57, 89, 83], [55, 57, 93, 82], [53, 81, 98, 83], [93, 90, 33, 82], [80, 78, 69, 61], [76, 85, 98, 69], [92, 33, 85, 77], [90, 52, 81, 61], [82, 70, 86, 50], [90, 91, 82, 42], [48, 67, 99, 89], [33, 78, 94, 89], [74, 21, 93, 98], [67, 100, 40, 86], [76, 30, 91, 98], [88, 56, 64, 95], [52, 64, 90, 83], [100, 94, 37, 79], [81, 93, 77, 33], [94, 41, 82, 68], [41, 95, 82, 75], [75, 96, 77, 68], [60, 96, 57, 91], [78, 85, 46, 88], [53, 87, 97, 63], [89, 95, 45, 95], [85, 45, 97, 84], [88, 78, 86, 53], [29, 97, 96, 89], [100, 41, 87, 84], [82, 70, 78, 90], [54, 94, 87, 78], [90, 38, 100, 78], [97, 50, 99, 69], [94, 59, 57, 80], [83, 66, 50, 95], [100, 75, 43, 80], [72, 98, 62, 54], [84, 73, 98, 96], [73, 83, 59, 92], [97, 91, 64, 76], [89, 52, 72, 90], [89, 44, 76, 91], [80, 60, 94, 57], [93, 88, 50, 79], [92, 77, 67, 95], [92, 42, 87, 98], [78, 83, 84, 53], [80, 89, 73, 99], [82, 30, 89, 89], [86, 88, 72, 96], [69, 96, 100, 19], [80, 58, 99, 89], [82, 95, 28, 80], [96, 96, 66, 76], [43, 61, 87, 93], [98, 87, 89, 17], [58, 94, 63, 82], [61, 65, 95, 71], [70, 100, 85, 52], [96, 85, 41, 63], [77, 51, 95, 90], [96, 93, 64, 54], [16, 94, 100, 76], [81, 77, 86, 91], [76, 81, 90, 75], [85, 60, 82, 61], [89, 36, 74, 92], [79, 97, 83, 94], [67, 95, 65, 66], [85, 80, 28, 95], [100, 99, 86, 84], [22, 100, 100, 76], [78, 81, 87, 87], [74, 82, 78, 72], [97, 61, 70, 58], [82, 62, 84, 90], [96, 65, 31, 92], [95, 100, 18, 85], [98, 92, 51, 60], [46, 96, 75, 79], [86, 86, 19, 99], [79, 41, 83, 93], [99, 78, 77, 56], [60, 79, 80, 78], [45, 74, 93, 72], [44, 87, 100, 94], [71, 70, 62, 86], [74, 90, 79, 69], [88, 96, 79, 43], [100, 81, 53, 53], [65, 81, 88, 90], [92, 89, 83, 85], [51, 56, 95, 92], [50, 62, 81, 95], [94, 94, 37, 83], [88, 73, 78, 45], [81, 96, 85, 72], [51, 98, 93, 88], [96, 84, 51, 69], [72, 94, 98, 72], [94, 35, 85, 73], [53, 77, 99, 97], [68, 84, 95, 83], [74, 79, 84, 94], [83, 92, 86, 60], [88, 79, 80, 57], [85, 70, 82, 97], [61, 65, 94, 67], [94, 88, 60, 85], [66, 97, 80, 100], [83, 93, 73, 51], [93, 56, 73, 71], [54, 97, 69, 96], [57, 76, 99, 64], [62, 81, 88, 72], [98, 84, 91, 11], [94, 93, 74, 59], [94, 76, 77, 65], [93, 84, 99, 17], [79, 83, 97, 67], [64, 85, 38, 99], [48, 74, 95, 94], [86, 56, 71, 88], [92, 96, 97, 39], [80, 79, 86, 88], [83, 93, 84, 32], [48, 75, 90, 90], [94, 34, 81, 88], [84, 78, 95, 28], [57, 96, 86, 94], [91, 86, 65, 88], [94, 46, 91, 95], [94, 97, 63, 97], [70, 93, 93, 95], [75, 79, 56, 88], [47, 93, 93, 53], [69, 43, 80, 100], [93, 70, 52, 95], [63, 91, 89, 70], [78, 56, 93, 75], [90, 69, 95, 92], [100, 74, 92, 98], [77, 81, 50, 86], [38, 93, 93, 94], [83, 72, 74, 74], [94, 86, 73, 67], [84, 73, 81, 57], [91, 51, 83, 100], [75, 80, 85, 97], [97, 72, 71, 80], [99, 93, 76, 39], [97, 75, 94, 69], [100, 93, 72, 36], [94, 76, 64, 62], [47, 99, 100, 85], [51, 95, 97, 73], [84, 87, 88, 92], [65, 94, 84, 88], [61, 99, 81, 82], [77, 62, 98, 73], [66, 75, 79, 99], [98, 27, 80, 91], [58, 100, 54, 92], [76, 33, 94, 87], [74, 75, 89, 96], [57, 92, 99, 92], [72, 99, 97, 39], [70, 94, 70, 50], [80, 93, 69, 51], [72, 96, 83, 99], [69, 100, 49, 77], [75, 79, 98, 89], [63, 86, 60, 97], [71, 98, 52, 64], [86, 37, 98, 90], [86, 98, 97, 62], [63, 99, 85, 79], [80, 90, 74, 89], [84, 83, 74, 46], [100, 73, 62, 57], [81, 67, 99, 71], [86, 17, 94, 96]]
dataset = [(np.array([selection[i]]), i//500) for i in range(len(selection))]


W1 = []
f1 = open('neural_network/W1', 'r')
for i in f1:
    W1.append(list(map(float, i.split())))
f1.close()


W2 = []
f2 = open('W2', 'r')
for i in f2:
    W2.append(list(map(float, i.split())))
f2.close()


b1 = []
f3 = open('b1', 'r')
for i in f3:
    b1.append(list(map(float, i.split())))
f3.close()


b2 = []
f4 = open('b2', 'r')
for i in f4:
    b2.append(list(map(float, i.split())))
f4.close()
